"use strict";const s=require("electron"),a=require("path"),f={dev:!s.app.isPackaged};process.platform,process.platform,process.platform;const w={watchWindowShortcuts(t,n){if(!t)return;const{webContents:o}=t,{escToCloseWindow:l=!1,zoom:d=!1}=n||{};o.on("before-input-event",(r,e)=>{e.type==="keyDown"&&(f.dev?e.code==="F12"&&(o.isDevToolsOpened()?o.closeDevTools():(o.openDevTools({mode:"undocked"}),console.log("Open dev tool..."))):e.code==="KeyR"&&(e.control||e.meta)&&r.preventDefault(),l&&e.code==="Escape"&&e.key!=="Process"&&(t.close(),r.preventDefault()),d||(e.code==="Minus"&&(e.control||e.meta)&&r.preventDefault(),e.code==="Equal"&&e.shift&&(e.control||e.meta)&&r.preventDefault()))})},registerFramelessWindowIpc(){s.ipcMain.on("win:invoke",(t,n)=>{const o=s.BrowserWindow.fromWebContents(t.sender);o&&(n==="show"?o.show():n==="showInactive"?o.showInactive():n==="min"?o.minimize():n==="max"?o.isMaximized()?o.unmaximize():o.maximize():n==="close"&&o.close())})}};process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";const p=a.join(__dirname,"preload.js"),m=a.join(__dirname,"../.output/public");let i=null;async function c(){i=new s.BrowserWindow({width:1200,height:670,show:!1,autoHideMenuBar:!0,center:!0,title:"Note App",frame:!1,vibrancy:"under-window",visualEffectState:"active",titleBarStyle:"hidden",trafficLightPosition:{x:15,y:10},webPreferences:{preload:p,sandbox:!0,contextIsolation:!0}}),i.on("ready-to-show",()=>{i==null||i.show()}),i.webContents.setWindowOpenHandler(t=>(s.shell.openExternal(t.url),{action:"deny"})),s.app.isPackaged?i.loadFile(a.join(m,"index.html")):(i.loadURL(process.env.VITE_DEV_SERVER_URL),i.webContents.openDevTools())}s.app.on("window-all-closed",()=>{i=null,process.platform!=="darwin"&&s.app.quit()});s.app.whenReady().then(()=>{s.app.on("browser-window-created",(t,n)=>{w.watchWindowShortcuts(n)}),c(),s.app.on("activate",function(){s.BrowserWindow.getAllWindows().length===0&&c()})});
